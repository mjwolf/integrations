# Service Info

## Common use cases

*   **Forensic Investigation and Threat Hunting**: Analysts can identify suspicious network activity in Elastic and pivot directly to the EndaceProbe to inspect the full packet capture for definitive evidence.
*   **Network Performance Troubleshooting**: Monitor network flow metadata and system health logs in Elastic to identify performance bottlenecks, then use Endace's precision timing for deep-dive analysis.
*   **Security Compliance and Auditing**: Centralize EndaceProbe OSm system and audit logs within Elastic to maintain a unified record of administrative access and appliance health across the security fabric.

## Data types collected

*   **Logs**: System health logs, OSm operational events, and administrative audit trails.
*   **Events**: Network flow metadata (IPFIX/NetFlow) encapsulated in syslog messages and security alerts triggered by the appliance.

## Compatibility

*   **EndaceProbe OSm**: Version 7.1 and later are recommended for full feature support.
*   **EndaceFlow**: Compatible with versions capable of forwarding flow data via syslog.
*   **Elastic Stack**: Compatible with versions 8.x and above.

## Scaling and Performance

The integration is designed to handle high-velocity flow metadata generated by EndaceProbes, which are capable of monitoring 10Gbps to 100Gbps+ links. Throughput to Elastic is primarily determined by the volume of flow records exported; for high-traffic environments, utilize a dedicated Elastic Agent or multiple agents behind a load balancer to manage the syslog ingestion load.

# Set Up Instructions

## Vendor prerequisites

*   **Endace Support Portal Account**: Required to access detailed product documentation and OSm firmware updates.
*   **Administrative Access**: Credentials for the EndaceProbe OSm web interface or CLI.
*   **Support Contract**: Active contract for software updates and technical support from Endace.

## Elastic prerequisites

*   **Elastic Agent**: Installed and running on a host reachable by the EndaceProbe.
*   **Integration Policy**: An Elastic Agent policy configured with the Endace integration and a syslog input.
*   **Network Connectivity**: Ensure firewall rules allow UDP/TCP traffic on the configured syslog port (default: 514 or 1514).

## Vendor set up steps

1.  Log in to the **EndaceProbe OSm** web administration interface.
2.  Navigate to **System > Configuration** or the **Logging** menu.
3.  Locate the **Remote Logging** or **External Syslog Servers** section.
4.  Define a new remote destination with the following parameters:
    *   **Hostname/IP**: The address of the Elastic Agent.
    *   **Port**: The port defined in your Elastic integration (e.g., `514`).
    *   **Protocol**: Matches your Elastic input (UDP is standard, TCP is recommended for reliability).
    *   **Format**: Select RFC 5424 or RFC 3164 as supported by your OSm version.
5.  Select the log facilities or severity levels (e.g., Audit, System, Flow) to be forwarded.
6.  Save and apply the configuration to initiate data transmission.

## Kibana set up steps

1.  In Kibana, navigate to **Management > Integrations**.
2.  Search for **Endace** and select the integration.
3.  Click **Add Endace**.
4.  Configure the integration name and the syslog settings (Host, Port, and Protocol) to match your EndaceProbe configuration.
5.  Assign the integration to an **Agent Policy** and click **Save and continue**.
6.  Deploy the agent if not already active to start receiving data.

# Validation Steps

1.  **Check Data Stream**: Navigate to **Kibana > Discover** and filter for `data_stream.dataset : "endace.*"` to confirm logs are arriving.
2.  **Verify Field Mapping**: Ensure fields such as `endace.probe.name`, `source.ip`, and `destination.ip` are correctly populated.
3.  **Test Pivot**: If using the Endace Fusion Connector features, click a "Pivot to Endace" link in a dashboard to ensure it correctly opens the Endace Management Console at the specific timestamp.
4.  **Monitor Dashboard**: Open the Endace Overview dashboard in Kibana to verify visualization of flow and system metrics.

# Troubleshooting

## Common Configuration Issues

*   **Connectivity Blocked**: Ensure that firewalls (iptables, firewalld, or hardware firewalls) allow traffic on the specific port used by the Elastic Agent syslog input.
*   **Incorrect Facility**: If logs are missing, ensure the EndaceProbe facility (e.g., local7) matches the filtering rules in the Elastic Agent policy.
*   **Hostname Resolution**: Use IP addresses instead of hostnames for the syslog destination if DNS resolution is not configured on the EndaceProbe.

## Ingestion Errors

*   **Parsing Failures**: If `error.message` contains "failed to parse syslog", verify if the EndaceProbe is sending RFC 3164 (legacy) or RFC 5424 format and update the integration's format setting accordingly.
*   **Timezone Mismatch**: If events appear in the future or past, verify that both the EndaceProbe and the Elastic Agent host are synchronized via NTP.

## API Authentication Errors

*   **Endace Fusion API**: If using API-based lookups, ensure the API token generated in OSm has the necessary "Monitoring" or "API" roles and hasn't expired.
*   **Credential Mismatch**: Verify that the username and password used for pivoting from Kibana to Endace have permissions to view packet data on the target appliance.

## Vendor Resources

*   [Endace Support Portal](https://support.endace.com/)
*   [Endace OSm Documentation](https://www.endace.com/osm)
*   [Endace Technical Resources](https://www.endace.com/resources)

# Documentation sites

*   [Endace Integration - Elastic Documentation](https://www.elastic.co/docs/reference/integrations/endace)
*   [Endace Product Overview](https://www.endace.com/endaceprobe)
*   [Endace/Elastic Solution Brief](https://www.endace.com/elastic-security)